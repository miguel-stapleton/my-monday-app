import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as r}from"../../tests/testIds.js";import i from"classnames";import{BaseSizes as a}from"../../constants/sizes.js";import s,{forwardRef as l,useRef as u,useContext as c,useMemo as d,useState as p,useEffect as m,useCallback as f}from"react";import v,{createFilter as O,components as b}from"react-select";import g from"react-select/async";import j from"react-select/base";import{noop as C}from"lodash-es";import y from"./components/menu/menu.js";import M from"./components/DropdownIndicator/DropdownIndicator.js";import h from"./components/option/option.js";import w from"./components/singleValue/singleValue.js";import S from"./components/ClearIndicator/ClearIndicator.js";import I from"./components/MultiValueContainer/MultiValueContainer.js";import{isClient as D}from"../../utils/ssr-utils.js";import{DROPDOWN_CHIP_COLORS as V,DROPDOWN_MENU_PLACEMENT as P,DROPDOWN_MENU_POSITION as R,ADD_AUTO_HEIGHT_COMPONENTS as L,defaultCustomStyles as x,DROPDOWN_ID as E,DROPDOWN_MENU_ID as N,DROPDOWN_MENU_ARIA_LABEL as W,DROPDOWN_INPUT_ARIA_LABEL as A}from"./DropdownConstants.js";import T,{customTheme as z}from"./Dropdown.styles.js";import F from"./components/Control/Control.js";import B from"../Text/Text.js";import k from"./components/menu/menu.module.scss.js";import q from"./Dropdown.module.scss.js";import{withStaticProps as H}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";import{ComponentVibeId as _}from"../../tests/constants.js";import G from"../LayerProvider/LayerContext.js";var K=H(l((function(a,l){var O=a.className,V=a.optionWrapperClassName,P=a.singleValueWrapperClassName,R=a.dropdownMenuWrapperClassName,H=a.placeholder,K=void 0===H?"":H,J=a.allowPlaceholderEllipsis,Q=a.disabled,U=void 0!==Q&&Q,X=a.readOnly,Y=void 0!==X&&X,Z=a.onMenuOpen,$=void 0===Z?C:Z,ee=a.onMenuClose,ne=void 0===ee?C:ee,oe=a.onFocus,te=void 0===oe?C:oe,re=a.onBlur,ie=void 0===re?C:re,ae=a.onScroll,se=void 0===ae?C:ae,le=a.onMenuScrollToBottom,ue=void 0===le?C:le,ce=a.onChange,de=void 0===ce?C:ce,pe=a.searchable,me=void 0===pe||pe,fe=a.captureMenuScroll,ve=void 0!==fe&&fe,Oe=a.options,be=void 0===Oe?[]:Oe,ge=a.defaultValue,je=a.value,Ce=a.noOptionsMessage,ye=a.openMenuOnFocus,Me=a.openMenuOnClick,he=a.clearable,we=void 0===he||he,Se=a.OptionRenderer,Ie=a.optionRenderer,De=a.ValueRenderer,Ve=a.valueRenderer,Pe=a.menuRenderer,Re=a.menuPlacement,Le=void 0===Re?"bottom":Re,xe=a.rtl,Ee=a.size,Ne=void 0===Ee?"medium":Ee,We=a.asyncOptions,Ae=a.cacheOptions,Te=a.defaultOptions,ze=a.isVirtualized,Fe=a.menuPortalTarget,Be=a.extraStyles,ke=void 0===Be?x:Be,qe=a.maxMenuHeight,He=a.menuIsOpen,_e=a.tabIndex,Ge=void 0===_e?"0":_e,Ke=a.id,Je=void 0===Ke?E:Ke,Qe=a.menuId,Ue=void 0===Qe?N:Qe,Xe=a.menuAriaLabel,Ye=void 0===Xe?W:Xe,Ze=a.inputAriaLabel,$e=void 0===Ze?A:Ze,en=a.autoFocus,nn=void 0!==en&&en,on=a.multi,tn=void 0!==on&&on,rn=a.multiline,an=void 0!==rn&&rn,sn=a.onOptionRemove,ln=a.onOptionSelect,un=a.onClear,cn=a.onInputChange,dn=void 0===cn?C:cn,pn=a.closeMenuOnSelect,mn=void 0===pn?!tn:pn,fn=a.closeMenuOnScroll,vn=void 0!==fn&&fn,On=a.withMandatoryDefaultOptions,bn=void 0!==On&&On,gn=a.isOptionSelected,jn=a.insideOverflowContainer,Cn=void 0!==jn&&jn,yn=a.insideOverflowWithTransformContainer,Mn=void 0!==yn&&yn,hn=a.insideLayerContext,wn=void 0!==hn&&hn,Sn=a.tooltipContent,In=void 0===Sn?"":Sn,Dn=a.onKeyDown,Vn=void 0===Dn?C:Dn,Pn=a.isLoading,Rn=void 0!==Pn&&Pn,Ln=a.loadingMessage,xn=a.ariaLabel,En=a.tabSelectsValue,Nn=void 0===En||En,Wn=a.popupsContainerSelector,An=a.filterOption,Tn=a.menuPosition,zn=void 0===Tn?"absolute":Tn,Fn=a["data-testid"],Bn=a.withGroupDivider,kn=void 0!==Bn&&Bn,qn=a.inputValue,Hn=a.blurInputOnSelect,_n=a.multiValueDialogClassName,Gn=u(),Kn=c(G).layerRef,Jn=wn&&(null==Kn?void 0:Kn.current)||Fe||Wn&&document.querySelector(Wn),Qn=d((function(){return ge?Array.isArray(ge)?ge.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},ge),{isMandatory:!0}):ge}),[ge]);j.prototype.renderLiveRegion=function(){return null};var Un=p(null),Xn=e(Un,2),Yn=Xn[0],Zn=Xn[1];m((function(){D()&&(!function(){try{return"function"==typeof require&&"undefined"!=typeof module&&"undefined"!=typeof process&&"test"===process.env.NODE_ENV}catch(e){return!1}}()?import("react-windowed-select").then((function(e){Zn((function(){return e.WindowedMenuList}))})):Zn((function(){return require("react-windowed-select").WindowedMenuList})))}),[]);var $n=p(Qn||[]),eo=e($n,2),no=eo[0],oo=eo[1],to=p(""),ro=e(to,2),io=ro[0],ao=ro[1],so=Ie||Se,lo=Ve||De,uo=!!je,co=null!=je?je:no,po=d((function(){return Array.isArray(co)?co.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[co]),mo=d((function(){return xn||"".concat(Y?"Readonly ":""," ").concat(In," ").concat(Array.isArray(co)?"Selected: ".concat(co.map((function(e){return e.label})).join(", ")):"Select")}),[xn,Y,co,In]),fo=tn?co:je,vo=d((function(){var o=T({size:Ne,rtl:xe,insideOverflowContainer:Cn,controlRef:Gn,insideOverflowWithTransformContainer:Mn,withGroupDivider:kn,searchable:me,allowPlaceholderEllipsis:J}),t=ke(o),r=Object.entries(t).reduce((function(t,r){var i=e(r,2),a=i[0],s=i[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],r=t?t(e,n):e;return s(r,n)})))}),{});if(tn){an&&L.forEach((function(e){var n=r[e];r[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var i=r.valueContainer;r.valueContainer=function(e,n){return Object.assign(Object.assign({},i(e,n)),{paddingLeft:6})}}return r}),[Ne,xe,Cn,Mn,J,ke,tn,an]),Oo=f((function(e){return s.createElement(y,Object.assign({},e,{id:Ue,ariaLabel:Ye,Renderer:Pe,dropdownMenuWrapperClassName:R,onScroll:se}))}),[R,Pe,Ue,Ye,se]),bo=f((function(e){return s.createElement(M,Object.assign({},e,{size:Ne}))}),[Ne]),go=f((function(e){return s.createElement(h,Object.assign({setFocusedOptionId:ao},e,{Renderer:so,optionWrapperClassName:V}))}),[so,V,ao]),jo=f((function(e){var n=e.selectProps,o=n.focusedOptionId,t=n.menuIsOpen;return s.createElement(b.Input,Object.assign({},e,{"aria-activedescendant":o&&t?o:"",role:"combobox","aria-expanded":!Y&&t,"aria-label":$e,"aria-controls":Ue,readOnly:!me||void 0}))}),[Ue,Y]),Co=f((function(e){return s.createElement(w,Object.assign({},e,{readOnly:Y,Renderer:lo,selectedOption:co[0],singleValueWrapperClassName:P}))}),[lo,Y,co,P]),yo=f((function(e){return s.createElement(S,Object.assign({},e,{size:Ne}))}),[Ne]),Mo=d((function(){return function(e,n){sn&&sn(po[e]);var o=Array.isArray(co)?co.filter((function(n){return n.value!==e})):co;de&&de(o,n),oo(o)}}),[de,sn,co,po]),ho=d((function(){return{selectedOptions:co,onSelectedDelete:Mo,isMultiline:an,insideOverflowContainer:Cn,insideOverflowWithTransformContainer:Mn,controlRef:Gn,tooltipContent:In,popupsContainerSelector:wn?null==Kn?void 0:Kn.current:Wn,size:Ne,dialogClassName:_n}}),[co,Mo,an,Cn,Mn,In,Kn,Wn,wn,Ne,_n]),wo=We?g:v;wo=wo.default||wo;var So=Object.assign({},We&&Object.assign({loadOptions:We,cacheOptions:Ae},Te&&{defaultOptions:Te})),Io=Object.assign(Object.assign({},!We&&{options:be}),tn&&{isMulti:!0}),Do=f((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(k.dropdownMenuWrapper))&&(vn||Cn||Mn)}),[Cn,Mn,vn]),Vo=d((function(){return J?s.createElement(B,{type:"text2",color:"inherit"},K):K}),[J,K]);return s.createElement(wo,Object.assign({className:i(q.dropdown,O),selectProps:ho,components:Object.assign(Object.assign({DropdownIndicator:bo,Menu:Oo,ClearIndicator:yo,Input:jo,Option:go,Control:F,SingleValue:Co},tn&&{MultiValue:C,ValueContainer:I}),ze&&Yn&&{MenuList:Yn}),closeMenuOnScroll:Do,size:Ne,noOptionsMessage:Ce,placeholder:Vo,isDisabled:U,isClearable:!Y&&we,isSearchable:!Y,readOnly:Y,"aria-readonly":Y,"aria-label":mo,"aria-details":In,"aria-haspopup":"listbox",defaultValue:ge,value:fo,onMenuOpen:$,onMenuClose:ne,onFocus:te,onBlur:ie,onMenuScrollToBottom:ue,captureMenuScroll:ve,onChange:function(e,n){switch(de&&de(e,n),n.action){case"select-option":var t=tn?n.option:e;ln&&ln(t),uo||oo([].concat(o(co),[t]));break;case"clear":un&&un(),uo||oo(bn?Qn:[])}},onKeyDown:Vn,onInputChange:dn,openMenuOnFocus:ye,openMenuOnClick:Me,focusedOptionId:io,isRtl:xe,styles:vo,theme:z,maxMenuHeight:qe,menuPortalTarget:Jn,menuPlacement:Le,menuPosition:zn,menuIsOpen:!Y&&He,tabIndex:Ge,id:Je,"data-testid":Fn||t(r.DROPDOWN,Je),"data-vibe":_.DROPDOWN,autoFocus:nn,closeMenuOnSelect:mn,ref:l,withMandatoryDefaultOptions:bn,isOptionSelected:gn,isLoading:Rn,loadingMessage:Ln,tabSelectsValue:Nn,filterOption:An,inputValue:qn,blurInputOnSelect:Hn},So,Io))})),{sizes:a,chipColors:V,menuPlacements:P,menuPositions:R,createFilter:O});export{K as default};
//# sourceMappingURL=Dropdown.js.map
