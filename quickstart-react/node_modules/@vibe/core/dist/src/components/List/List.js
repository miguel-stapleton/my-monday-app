import{slicedToArray as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import e from"classnames";import r,{forwardRef as i,useRef as o,useState as s,useCallback as n,useEffect as a,useMemo as l}from"react";import c from"../../hooks/useMergeRef.js";import u from"../../hooks/useKeyEvent/index.js";import{VirtualizedListItems as m}from"./VirtualizedListItems/VirtualizedListItems.js";import{keyCodes as d,UP_DOWN_ARROWS as f}from"../../constants/keyCodes.js";import{withStaticProps as p}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";import{ListWrapperComponentType as v}from"./ListConstants.js";import{getTestId as b,ComponentDefaultTestId as y}from"../../tests/testIds.js";import{ListContext as j}from"./utils/ListContext.js";import{useListId as I,getListItemIndexById as L,getNextListItemIndex as x,getPrevListItemIndex as h,getListItemIdByIndex as k,isListItem as A,getListItemComponentType as E}from"./utils/ListUtils.js";import g from"./List.module.scss.js";import{ComponentVibeId as R}from"../../tests/constants.js";var C=p(i((function(i,p){var C=i.className,O=i.id,P=i.component,T=void 0===P?v.UL:P,V=i.children,_=i.ariaLabel,D=i.ariaDescribedBy,N=i["aria-controls"],S=i.renderOnlyVisibleItems,U=void 0!==S&&S,W=i.style,z=i.role,B=void 0===z?"listbox":z,H=i["data-testid"],M=o(null),w=c(p,M),F=o([]),K=I(O),q=s(0),G=t(q,2),J=G[0],Q=G[1],X=T,Y=n((function(t){var e;Q(L(F,t)),null===(e=null==M?void 0:M.current)||void 0===e||e.setAttribute("aria-activedescendant",t)}),[]),Z=n((function(t){if(!U){t.preventDefault();var e=t.key===d.UP_ARROW,r=void 0;t.key===d.DOWN_ARROW&&F.current.length>J+1?r=x(J,F):e&&J>0&&(r=h(J,F)),void 0!==r&&(Y(k(F,r)),F.current[r].focus())}}),[J,U,Y]);u({keys:f,callback:Z,ref:M}),a((function(){var t=F.current.findIndex((function(t){return t instanceof HTMLElement&&A(t)&&"true"===(null==t?void 0:t.getAttribute("aria-selected"))}));if(-1!==t)Y(k(F,t));else{var e=F.current.findIndex((function(t){return A(t)}));-1!==e&&Y(k(F,e))}}),[Y]);var $=l((function(){var t=Array.isArray(V)?V:[V];return U?t=r.createElement(m,null,t):(F.current=F.current.slice(0,t.length),t=r.Children.map(t,(function(t,e){if(!r.isValidElement(t))return t;var i=t.props.id||"".concat(K,"-item-").concat(e),o=F.current[e],s=null==o||A(o);return r.cloneElement(t,{ref:function(t){return F.current[e]=t},tabIndex:J===e&&s?0:-1,id:i,component:E(T),role:t.props.role})}))),t}),[V,T,J,K,U]);return r.createElement(j.Provider,{value:{updateFocusedItem:Y}},r.createElement(X,{"data-testid":H||b(y.LIST,O),"data-vibe":R.LIST,ref:w,style:W,className:e(g.list,C),id:K,"aria-label":_,"aria-describedby":D,"aria-controls":N,tabIndex:-1,role:B},$))})),{components:v});export{C as default};
//# sourceMappingURL=List.js.map
