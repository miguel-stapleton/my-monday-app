import{slicedToArray as e}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{useState as n,useRef as t,useContext as o,useEffect as i,useCallback as r}from"react";import{GridKeyboardNavigationContext as a}from"../../components/GridKeyboardNavigationContext/GridKeyboardNavigationContext.js";import u from"../useFullKeyboardListeners.js";import c from"../useEventListener/index.js";import{getActiveIndexFromInboundNavigation as s,calcActiveIndexAfterArrowNavigation as d}from"./gridKeyboardNavigationHelper.js";import{useLastNavigationDirection as l}from"../../components/Menu/Menu/hooks/useLastNavigationDirection.js";var f=-1;function m(m){var v=m.ref,b=m.itemsCount,I=m.numberOfItemsInLine,p=m.onItemClicked,g=m.entryFocusStrategy,x=void 0===g?"directional":g,N=m.getItemByIndex,y=void 0===N?function(e){}:N,O=m.focusOnMount,j=void 0!==O&&O,C=m.focusItemIndexOnMount,L=void 0===C?f:C,k=m.disabledIndexes,K=void 0===k?[]:k,M=n(j&&L!==f),A=e(M,2),S=A[0],h=A[1],w=t(!1),B=n(S?L:f),D=e(B,2),E=D[0],F=D[1],G=n(!0),H=e(G,2),_=H[0],P=H[1],R=o(a);i((function(){w.current?h(!1):w.current=!0}),[E]);var T=r((function(){var e;return null===(e=v.current)||void 0===e?void 0:e.blur()}),[v]),q=l().lastNavigationDirectionRef,z=r((function(){if(E===f){var e=q.current;F("directional"===x&&e?s({direction:e,numberOfItemsInLine:I,itemsCount:b}):0),P(!0)}else P(!0)}),[E,x,b,q,I,F,P]),J=r((function(){P(!1)}),[P]),Q=r((function(){P(!0),F(f)}),[F]);c({eventName:"focus",callback:z,ref:v}),c({eventName:"mousedown",callback:J,ref:v}),c({eventName:"blur",callback:Q,ref:v}),i((function(){var e;E>-1&&(null===(e=v.current)||void 0===e||e.focus())}),[E,v]);var U=r((function(e){P(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),F(e),p(y(e),e)}),[F,p,y]),V=r((function(){if(_)return U(E,!0)}),[_,U,E]);return u({ref:v,onSelectionKey:V,onArrowNavigation:function(e){if(P(!0),E!==f){var n=d({activeIndex:E,itemsCount:b,numberOfItemsInLine:I,direction:e,disabledIndexes:K}),t=n.nextIndex;n.isOutbound?null==R||R.onOutboundNavigation(v,e):F(t)}else F(0)},onEscape:T,focusOnMount:j}),{activeIndex:_?E:f,onSelectionAction:U,isInitialActiveState:S}}export{m as default};
//# sourceMappingURL=useGridKeyboardNavigation.js.map
